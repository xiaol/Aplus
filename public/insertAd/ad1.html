<link rel="stylesheet" type="text/css" href="news.css">
<script src="jquery-2.1.4.min.js"></script>
<style type="text/css">
	body {
        background: #fff;
        font-family: Helvetica Neue, Helvetica, Arial, sans-serif;
        font-size: 14px;
        color:#000;
        margin: 0;
        padding: 0;
    }
    a{
    	text-decoration: none;
    	color: #000;
    }
    .swiper-container {
        width: 100%;
        height: 548px;
        margin: 0px auto 0px auto;
        position: relative;
        /*display: none;*/
    }
    .swiper-slide {
        text-align: center;
        font-size: 18px;
        background: #f7f7f7;
        width: 60%;

        /* Center slide text vertically */
       /* display: -webkit-box;
        display: -ms-flexbox;
        display: -webkit-flex;
        display: flex;*/
        -webkit-box-pack: center;
        -ms-flex-pack: center;
        -webkit-justify-content: center;
        justify-content: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        -webkit-align-items: center;
        align-items: center;
    }
    .swiper-slide:nth-child(2n) {
        width: 40%;
    }
    .swiper-slide:nth-child(3n) {
        width: 20%;
    }
	.news-bar{
		display: block;
		color: #fff;
		text-align: left;
		height: 50px;
		line-height: 50px;
		background-color: #000;
		padding-left: 24px;
		padding-right: 24px;
		font-size: 24px;
		position: absolute;
		top:0px;
		left: 0px;
		width:-moz-calc(100% - 48px);
	    width:-webkit-calc(100% - 48px);
	    width: calc(100% - 48px);
		z-index: 10
	}
	.news-close{
		float: right;
	}
	.news-info{
		margin: 15px auto 0px auto;
		width:-moz-calc(100% - 60px);
	    width:-webkit-calc(100% - 60px);
	    width: calc(100% - 60px);
		overflow: hidden;
		font-size: 29px;
		line-height: 40px;
		color: #404040;
		height: 483px;
		position: relative;
		top:50px;
	}
	.news-info img{
		max-width: 100%;
		max-height: 300px;
	}
	.news-info .news-text{
		text-align: left;
		margin-top: 10px;
		max-height: 87px;
		overflow: hidden;
	}
	.news-info .news-foot{
		font-size: 23px;
		color: #999999;
		text-align: left;
		line-height: normal;
		position: absolute;
		bottom: 25px;
	}
</style>
<div class="swiper-container swiper-container-horizontal" style="cursor: -webkit-grab;">
	<div class="news-bar">热点
			<div class="news-close">X</div>
		</div>
    <div class="swiper-wrapper" id="newInfo">
        <div class="swiper-slide">
	        <div class="news-info">
	        	<a target="_blank" href=""><img src="homeBg3.jpg"><div class="news-text">按实际发按实际发按实际发按实际发<br>按实际发按实际发按实际发按实际发按实际发按实际发按实际发按实际发</div></a>
		        <div class="news-foot">科技日报</div>
	        </div>
        </div>
    </div>
 
</div>
<script src="news.js"></script>
<script type="text/javascript">
    
    //日期计算
    Date.prototype.DateAdd = function(strInterval, Number) {   
	    var dtTmp = this;  
	    switch (strInterval) {   
	        case 's' :return new Date(Date.parse(dtTmp) + (1000 * Number));  
	        case 'n' :return new Date(Date.parse(dtTmp) + (60000 * Number));  
	        case 'h' :return new Date(Date.parse(dtTmp) + (3600000 * Number));  
	        case 'd' :return new Date(Date.parse(dtTmp) + (86400000 * Number));  
	        case 'w' :return new Date(Date.parse(dtTmp) + ((86400000 * 7) * Number));  
	        case 'q' :return new Date(dtTmp.getFullYear(), (dtTmp.getMonth()) + Number*3, dtTmp.getDate(), dtTmp.getHours(), dtTmp.getMinutes(), dtTmp.getSeconds());  
	        case 'm' :return new Date(dtTmp.getFullYear(), (dtTmp.getMonth()) + Number, dtTmp.getDate(), dtTmp.getHours(), dtTmp.getMinutes(), dtTmp.getSeconds());  
	        case 'y' :return new Date((dtTmp.getFullYear() + Number), dtTmp.getMonth(), dtTmp.getDate(), dtTmp.getHours(), dtTmp.getMinutes(), dtTmp.getSeconds());  
	    }  
	} 
    function dataConn (url, requestData, responseFn,type,token){
        $.ajax({
            type: (type != undefined ? type : "post"),
            url: url,
            dataType: "json",
            contentType: "application/json",
            data: requestData,
            jsonp:"callback",
            timeout: 1000000,
            crossDomain:true,
            cache: false,
            async: true,
            beforeSend: function(XMLHttpRequest,XMLHttpResponse,text){
                //设置header参数
                if(token){
	                XMLHttpRequest.setRequestHeader("Authorization", token);
                }
            },
            success: function(data, textStatus, xhr){
                if (data != null) {
                    // if (data.retCode != "00000") {
                    //     alert(data.retCode + " : " + data.retInfo);
                    //     return false;
                    // }
                    if (responseFn != undefined && typeof(responseFn) == "function") {
                       // try {
                            responseFn(data, textStatus,xhr);
                        //} catch (e) {
                          //  console.log("[PARSE ERROR] name : " + e.name + ", message: " + e.msg);

                        //}
                    }
                } 
            },
            error: function(XMLHttpRequest, error){
                if (error == "timeout") {
                    alert("请求超时：请求系统返回数据超时！请稍候再试吧…");
                }
            },
            complete: function(XMLHttpRequest, textStatus){
                
            }
        })
    }
    //游客注册
    var joinUrl  = "http://bdp.deeporiginalx.com/v2/au/sin/g",
    	joinType = "post",
    	joinData = {
		  "utype": 2,
		  "platform": 3
		},
		newListUrl = "http://bdp.deeporiginalx.com/v2/ns/fed/l?cid=1&tcr=",
		newListType = "get";
	var newDate = new Date();
	var mydate = Date.parse(newDate.DateAdd("d",-1));
	newListUrl += mydate;
	var stg = window.localStorage;
        dataConn(joinUrl,JSON.stringify(joinData),joinBack,joinType);
	if(stg.getItem("token")==null){
	    dataConn(joinUrl,JSON.stringify(joinData),joinBack,joinType);
	}else{
	    // dataConn(newListUrl,"",showNews,newListType,stg.getItem("token"));
	}
    function joinBack(data,status,xhr){
    	var token = "Basic " + xhr.getResponseHeader("Authorization")
    	// var token = "Basic " + 'dzUpKV93dWI1dTN3c2JhNmsyfjc4dTM3bydlKmI3bF83eeBucipnaTlzajBlY3kxNGUxbXh5ZnE2cGwuazYqcw';
    	stg.setItem("token",token);
	    dataConn(newListUrl,"",showNews,newListType,token);
    }
    function showNews(data){
    	if(data.code!=2000){ $("#newInfo").html("数据请求错误~"); return false;}
    	var backdata = data.data;
    	var aryLen = backdata.length;
    	if(aryLen>0){
    		for(var a=0;a<aryLen;a++){
    			if(backdata[a].imgs&&backdata[a].imgs.length>0){
	    			$("#newInfo").append('<div class="swiper-slide"><div class="news-info"><a target="_blank" href="'+ backdata[a].url +'"><img src="'+ backdata[a].imgs[0] +'">”'+ backdata[a].title +'</a></div></div>');

    			}else{
    			$("#newInfo").append('<div class="swiper-slide"><div class="news-info"><a target="_blank" href="'+ backdata[a].url +'">'+ backdata[a].title +'</a></div></div>');
    			}
    		}
    		var swiper = new Swiper('.swiper-container', {
		        pagination: '.swiper-pagination',
		        slidesPerView: 1.5,
		        slidesOffsetBefore : (window.innerWidth*(1.5-1)-30)/(1.5*1.8),
		        centeredSlides: false,
		        paginationClickable: true,
		        spaceBetween: 30,
		        grabCursor: true
		     //    onInit: function(swiper){
				   //  $(".swiper-container").show();
			    // }
		    });
    	}
    }
</script>